#!/usr/bin/perl
use strict;
use warnings;
use utf8;

#$MOJO_HOME/etc/plugins/auth.conf
#Default configuration for Ado::Plugin::Auth

{   
    #methods which will be displayed in the "Sign in" menu
    auth_methods => ['ado'],
    #Configurations for methods not provided by Mojolicious::Plugin::OAuth2
    providers => {
			#Add the rest of the needed configuration options 
            #to auth.development.conf or auth.production.conf only 
            #because this is highly sensitive information.
            # See https://developers.google.com/accounts/docs/OAuth2UserAgent
            # https://developers.google.com/oauthplayground/
    },
    #Add your routes definitions here.
    routes => [

        #the login form and authentication
        {   route => '/login/:auth_method',
            via   => ['GET', 'POST'],
            to    => {
                auth_method => 'ado',
                cb          => \&Ado::Plugin::Auth::login
            },
            description =>'GET: Renders a login form when :auth_method is "ado".'
            .' or authenticates a user when :auth_method is an OAuth2 provider.'.$/
            .'POST:authenticates a user.',
        },

        {   route =>'/token/:auth_method',
            via   => ['GET', 'POST'],
            to    => {
                auth_method => 'google',
                cb  => \&Ado::Plugin::Auth::get_token
            },
        },

        {   route => '/logout',
            to    => {cb => \&Ado::Plugin::Auth::logout}
        },
        {   route => '/test/authenticateduser',
            over  => {authenticated => 1},
            to    => 'test#authenticateduser'
        },

    ],
};
